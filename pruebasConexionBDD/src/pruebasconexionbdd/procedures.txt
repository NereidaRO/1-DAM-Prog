En cuanto a los procedures (tema de BADA que no nos da tiempo a ver este aÃ±o y que quiero ver en verano), el profesor
de ProgramaciÃ³n los ha nombrado. Al preguntarle a ChatGPT quÃ© es eso, me lo ha explicado como que son objetos que
se pueden crear en SQL como abreviaciones. Al hacer "exec nombreProcedure", este procedure se activarÃ¡, 
llevando a cabo la tarea (un select, update o lo que hayas definido antes). Pero para hacerlo por Java, es mÃ¡s difÃ­cil.
El cÃ³digo-ejemplo, explicado, es:

Â¡Por supuesto, Nereida! Vamos a analizar lÃ­nea por lÃ­nea el cÃ³digo de Java para ejecutar un **Stored Procedure** en SQL Server. ğŸ“Œ

---

### **CÃ³digo completo:**
```java
import java.sql.*;

public class EjecutarProcedure {
    public static void main(String[] args) {
        String url = "jdbc:sqlserver://localhost:1433;databaseName=MiBaseDeDatos";
        String usuario = "tu_usuario";
        String contraseÃ±a = "tu_contraseÃ±a";

        try (Connection conexion = DriverManager.getConnection(url, usuario, contraseÃ±a);
             CallableStatement cs = conexion.prepareCall("{call ObtenerUsuarios}")) {

            ResultSet rs = cs.executeQuery();

            while (rs.next()) {
                System.out.println("ID: " + rs.getInt("id") + ", Nombre: " + rs.getString("nombre"));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
```

---

## ğŸ” **ExplicaciÃ³n lÃ­nea a lÃ­nea**
### **1ï¸âƒ£ Importar las librerÃ­as necesarias**
```java
import java.sql.*;
```
ğŸ“Œ AquÃ­ importamos las librerÃ­as de Java necesarias para conectarnos a SQL Server y manejar la base de datos.  

- `java.sql.Connection` â†’ Para establecer la conexiÃ³n con la base de datos.  
- `java.sql.DriverManager` â†’ Para obtener la conexiÃ³n a travÃ©s del **JDBC**.  
- `java.sql.CallableStatement` â†’ Para ejecutar **Stored Procedures**.  
- `java.sql.ResultSet` â†’ Para manejar los resultados de una consulta.  

---

### **2ï¸âƒ£ Definir la clase principal y el mÃ©todo `main`**
```java
public class EjecutarProcedure {
    public static void main(String[] args) {
```
ğŸ“Œ Esto define la clase `EjecutarProcedure` y su mÃ©todo `main()`, que es donde empieza a ejecutarse el programa.

---

### **3ï¸âƒ£ Especificar los datos de conexiÃ³n**
```java
String url = "jdbc:sqlserver://localhost:1433;databaseName=MiBaseDeDatos";
String usuario = "tu_usuario";
String contraseÃ±a = "tu_contraseÃ±a";
```
ğŸ“Œ AquÃ­ definimos los datos de conexiÃ³n para SQL Server:

- `localhost:1433` â†’ Indica que el servidor SQL estÃ¡ en la misma computadora y usa el puerto **1433** (el predeterminado de SQL Server).
- `databaseName=MiBaseDeDatos` â†’ Especifica el nombre de la base de datos a la que queremos conectarnos.
- `usuario` y `contraseÃ±a` â†’ Son las credenciales para acceder a SQL Server.

**ğŸ‘€ Importante:** Si usas autenticaciÃ³n de Windows en lugar de usuario/contraseÃ±a, la URL cambiarÃ­a a:
```java
String url = "jdbc:sqlserver://localhost:1433;databaseName=MiBaseDeDatos;integratedSecurity=true";
```

---

### **4ï¸âƒ£ Establecer conexiÃ³n con la base de datos**
```java
try (Connection conexion = DriverManager.getConnection(url, usuario, contraseÃ±a);
```
ğŸ“Œ AquÃ­ usamos `DriverManager.getConnection(url, usuario, contraseÃ±a);` para conectarnos a SQL Server.

- Si la conexiÃ³n es exitosa, se almacena en el objeto `conexion`.
- La sintaxis `try (...)` con parÃ©ntesis usa **"try-with-resources"**, lo que significa que la conexiÃ³n se **cerrarÃ¡ automÃ¡ticamente** cuando el bloque `try` termine.

---

### **5ï¸âƒ£ Preparar la ejecuciÃ³n del Stored Procedure**
```java
CallableStatement cs = conexion.prepareCall("{call ObtenerUsuarios}");
```
ğŸ“Œ AquÃ­ creamos un objeto `CallableStatement`, que sirve para ejecutar un **Stored Procedure** en SQL Server.

- `prepareCall("{call ObtenerUsuarios}")` â†’ Indica que vamos a llamar al procedimiento almacenado llamado `ObtenerUsuarios`.  
- **Los `{call NombreDelProcedure}`** son la forma estÃ¡ndar de llamar a procedimientos almacenados en SQL Server desde Java.  

Si el procedimiento tuviera **parÃ¡metros**, lo pasarÃ­amos con `?` dentro de los parÃ©ntesis, asÃ­:
```java
CallableStatement cs = conexion.prepareCall("{call ObtenerUsuarioPorID(?)}");
cs.setInt(1, 5);  // Suponiendo que el procedimiento recibe un ID como parÃ¡metro
```

---

### **6ï¸âƒ£ Ejecutar la consulta**
```java
ResultSet rs = cs.executeQuery();
```
ğŸ“Œ Ejecutamos el procedimiento almacenado con `executeQuery()`, que devuelve un **ResultSet** (un conjunto de filas de la base de datos).

- **Si el Stored Procedure devuelve datos (como un `SELECT *`), usamos `executeQuery()`**.
- **Si el Stored Procedure solo realiza acciones (como `INSERT`, `UPDATE`, `DELETE`), usamos `executeUpdate()` en lugar de `executeQuery()`**.

---

### **7ï¸âƒ£ Leer los resultados**
```java
while (rs.next()) {
    System.out.println("ID: " + rs.getInt("id") + ", Nombre: " + rs.getString("nombre"));
}
```
ğŸ“Œ AquÃ­ recorremos los resultados obtenidos en `rs` (el `ResultSet`) con un `while`.

- `rs.next()` â†’ Avanza a la siguiente fila de resultados.
- `rs.getInt("id")` â†’ Obtiene el valor de la columna `id` como un nÃºmero entero.
- `rs.getString("nombre")` â†’ Obtiene el valor de la columna `nombre` como una cadena de texto.
- `System.out.println(...)` â†’ Muestra cada fila en la consola.

Ejemplo de salida en consola si la tabla tiene estos datos:
| id | nombre  |
|----|--------|
| 1  | Ana    |
| 2  | Pedro  |

ğŸ‘€ La salida en consola serÃ­a:
```
ID: 1, Nombre: Ana
ID: 2, Nombre: Pedro
```

---

### **8ï¸âƒ£ Manejo de errores**
```java
} catch (SQLException e) {
    e.printStackTrace();
}
```
ğŸ“Œ Si hay un error de conexiÃ³n o ejecuciÃ³n del Stored Procedure, se captura con `catch (SQLException e)`.

- `e.printStackTrace();` â†’ Muestra el error en la consola para que podamos depurarlo.

Errores comunes que podrÃ­as ver:
1. **"The TCP/IP connection to the host failed"** â†’ SQL Server no estÃ¡ configurado para aceptar conexiones remotas.
2. **"Login failed for user"** â†’ El usuario o la contraseÃ±a son incorrectos.
3. **"Could not find stored procedure"** â†’ El procedimiento almacenado no existe o el nombre es incorrecto.

---

### **âœ… Resumen rÃ¡pido**
ğŸ“Œ Este programa:
1. **Se conecta** a SQL Server.
2. **Ejecuta un Stored Procedure (`ObtenerUsuarios`)**.
3. **Recorre los resultados y los imprime** en consola.
4. **Maneja posibles errores**.

---

## **ğŸ”¥ Extra: CÃ³mo ejecutar un procedimiento con parÃ¡metros**
Si el procedimiento `ObtenerUsuarioPorID` recibe un **ID** como parÃ¡metro, el cÃ³digo en Java serÃ­a:

```java
CallableStatement cs = conexion.prepareCall("{call ObtenerUsuarioPorID(?)}");
cs.setInt(1, 5);  // Pasamos el valor 5 al parÃ¡metro
ResultSet rs = cs.executeQuery();
```

Esto equivaldrÃ­a a ejecutar en SQL:
```sql
EXEC ObtenerUsuarioPorID 5;
```

---

### **ğŸš€ Ahora tienes el control!**
Ya entiendes **lÃ­nea por lÃ­nea** cÃ³mo conectar Java con SQL Server usando Stored Procedures. ğŸ¯

Si tienes dudas o errores al probarlo, dime y lo solucionamos juntas. Â¡Vamos a por ello! ğŸš€ğŸ˜ƒ
